# Global redirect rules
# This configuration file contains global redirects for the documentation server
# It is deployed automatic into the nginx of the documentation server.
# This file is included in the VHost configuration and can contain any kind of redirect rules.
#
# WARNING: THIS FILE IS DIRECTLY DEPLOYED TO DOCS LIVE SERVER WHEN INTERCEPT PATCHES
#          ARE MERGED TO DEVELOP BRANCH. SYNTAX ERRORS WILL LEAD TO DOCS.TYPO3.ORG BEING DOWN!
#
# Example:
# location ~ ^/typo3cms/ViewHelperReference(.*)$ {
#    return 303 /other/typo3/ViewHelperReference/9.5/en-us$1;
#}

# Redirect master to main
location ~ (.*)/master/(.*)$ {
    return 303 $1/main/$2;
}

# Redirect minor versions to their LTS cuonterpart
location ~ ^/c/typo3/([^/]+)/11.[0-4]/(.*)$ {
    return 303 /c/typo3/$1/11.5/$2;
}

location ~ ^/c/typo3/([^/]+)/12.[0-3]/(.*)$ {
    return 303 /c/typo3/$1/12.4/$2;
}

location ~ ^/c/typo3/([^/]+)/13.[0-3]/(.*)$ {
    return 303 /c/typo3/$1/13.4/$2;
}

# Add short links
location = /installation {
    return 303 /permalink/t3coreapi:installation-index;
}

location = /upgrade {
    return 303 /permalink/t3coreapi:upgrading;
}

location = /system-requirements {
    return 303 /permalink/t3coreapi:system-requirements;
}

location = /core-contribution {
    return 303 /permalink/t3contribute:recommended-reading;
}

# Rewrite Upgrade guide links to new position in TYPO3 explained
location ~ ^/m/typo3/guide-installation/(main|13.4|12.4)/en-us/(.*)$ {
    return 301 /m/typo3/reference-coreapi/$1/en-us/Administration/Upgrade/$2;
}

# Rewrite TypoScript in 45 min guide links to new position in TypoScript reference
location ~ ^/m/typo3/tutorial-typoscript-in-45-minutes/(main|13.4|12.4)/en-us/(.*)$ {
    return 301 /m/typo3/reference-typoscript/$1/en-us/Guide/$2;
}

# Move Installation chapter
location ~ ^/m/typo3/reference-coreapi/(main|13.4|12.4)/en-us/Administration/Installation/Install.html$ {
    return 301 /m/typo3/reference-coreapi/$1/en-us/Administration/Installation/Index.html;
}

# Move TypoScript Syntax into TypoScript reference
location ~ ^/m/typo3/reference-coreapi/(main|13.4|12.4)/en-us/Configuration/TypoScript/Syntax/(.*)/Index.html$ {
    return 301 /m/typo3/reference-typoscript/$1/en-us/Syntax/$2/Index.html;
}

# Move HMENU special properties into data processor
location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/Configuration/TypoScript/Syntax/(?!Tmenu)(.*)$ {
    return 301 /m/typo3/reference-typoscript/$1/en-us/DataProcessing/MenuProcessor/$2;
}

# Rewrite Fluid VH reference links to new position
location ~ ^/typo3cms/ViewHelperReference/latest(.*)$ {
    return 303 /other/typo3/view-helper-reference/main/en-us$1;
}
location ~ ^/typo3cms/ViewHelperReference(.*)$ {
    return 303 /other/typo3/view-helper-reference/main/en-us$1;
}

# Redirect from 1.0 to main in how to document
location ~ ^/m/typo3/docs-how-to-document/1.0/en-us/(.*) {
    return 303 /m/typo3/docs-how-to-document/main/en-us/$1;
}

# Redirect from old rest reference to new
location ~ ^/m/typo3/docs-how-to-document/main/en-us/WritingReST/Reference/(.*) {
    return 303 /m/typo3/docs-how-to-document/main/en-us/Reference/ReStructuredText/$1;
}

# Redirect URLs of old ViewHelper reference to new ViewHelper reference for 12.4 and main
# (11 and below are static)
location ~ ^/other/typo3/view-helper-reference/(main|12.4)/en-us/typo3/backend/latest/(.*) {
    return 303 /other/typo3/view-helper-reference/$1/en-us/Backend/$2;
}
location ~ ^/other/typo3/view-helper-reference/(main|12.4)/en-us/typo3/core/latest/(.*) {
    return 303 /other/typo3/view-helper-reference/$1/en-us/Core/$2;
}
location ~ ^/other/typo3/view-helper-reference/(main|12.4)/en-us/(?:typo3fluid/fluid|typo3/fluid)/latest/(.*) {
    return 303 /other/typo3/view-helper-reference/$1/en-us/Global/$2;
}

# Move exceptions to standard location
location ~ ^/typo3cms/exceptions/main/en-us/(.*)$ {
    return 301 /m/typo3/reference-exceptions/main/en-us/$1;
}

# Rewrite Surf documentation links to new position
location ~ ^/surf/latest(.*)$ {
    return 303 /other/typo3/surf/2.0/en-us$1;
}
location ~ ^/surf(.*)$ {
    return 303 /other/typo3/surf/2.0/en-us$1;
}

# typo3/reference-tca
# properties of moved into index

location ~ ^/m/typo3/reference-tca/(main|12.4)/en-us/ColumnsConfig/Type/([^/]+)/Properties/.*$ {
    return 303 /m/typo3/reference-tca/$1/en-us/ColumnsConfig/Type/$2/Index.html;
}
location ~ ^/m/typo3/reference-tca/(main|12.4)/en-us/Ctrl/Properties/.*$ {
    return 303 /m/typo3/reference-tca/$1/en-us/Ctrl/Index.html;
}

# typo3/reference-coreapi
# redirects for moved sections



location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/ApiOverview/DatabaseRecords/Index.html$ {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Database/DatabaseRecords/Index.html;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/ApiOverview/DatabaseRecords/RecordObjects.html$ {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Database/DatabaseRecords/RecordObjects.html;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/ApiOverview/Database/BasicCrud/Index.html$ {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Database/DoctrineDbal/BasicCrud/Index.html;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/ApiOverview/Database/ClassOverview/Index.html$ {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Database/DoctrineDbal/ClassOverview/Index.html;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/ApiOverview/Database/Configuration/Index.html$ {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Database/DoctrineDbal/Configuration/Index.html;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/ApiOverview/Database/Connection/Index.html$ {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Database/DoctrineDbal/Connection/Index.html;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/ApiOverview/Database/ConnectionPool/Index.html$ {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Database/DoctrineDbal/ConnectionPool/Index.html;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/ApiOverview/Database/ExpressionBuilder/Index.html$ {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Database/DoctrineDbal/ExpressionBuilder/Index.html;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/ApiOverview/Database/Introduction/Index.html$ {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Database/DoctrineDbal/Introduction/Index.html;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/ApiOverview/Database/Middleware/Index.html$ {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Database/DoctrineDbal/Middleware/Index.html;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/ApiOverview/Database/QueryBuilder/Index.html$ {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Database/DoctrineDbal/QueryBuilder/Index.html;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/ApiOverview/Database/RestrictionBuilder/Index.html$ {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Database/DoctrineDbal/RestrictionBuilder/Index.html;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/ApiOverview/Database/Statement/Index.html$ {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Database/DoctrineDbal/Statement/Index.html;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/ApiOverview/Database/TipsAndTricks/Index.html$ {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Database/DoctrineDbal/TipsAndTricks/Index.html;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/ApiOverview/Database/Troubleshooting/Index.html$ {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Database/DoctrineDbal/Troubleshooting/Index.html;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4|12.4)/en-us/ExtensionArchitecture/Extbase/Reference/Domain/Model.html {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ExtensionArchitecture/Extbase/Reference/Domain/Model/Index.html;
}
location ~ ^/m/typo3/reference-coreapi/(main|13.4|12.4)/en-us/ExtensionArchitecture/Extbase/Reference/Domain/Repository.html {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ExtensionArchitecture/Extbase/Reference/Domain/Repository/Index.html;
}
location ~ ^/m/typo3/reference-coreapi/(main|13.4|12.4)/en-us/ExtensionArchitecture/Extbase/Reference/Domain/Persistence.html {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ExtensionArchitecture/Extbase/Reference/Domain/Persistence/Index.html;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/CodingGuidelines/PhpArchitecture/(.*) {
    return 303 /m/typo3/reference-coreapi/$1/en-us/PhpArchitecture/$2;
}

location ~ ^/m/typo3/reference-coreapi/(main|13.4)/en-us/CodingGuidelines/PhpArchitecture/(.*) {
    return 303 /m/typo3/reference-coreapi/$1/en-usCodingGuidelines/CodingBestPractices/$2;
}

location ~ ^/m/typo3/reference-coreapi/(main|11.5)/en-us/ApiOverview/LinkBrowser(.*) {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/LinkHandling$2;
}

location ~ ^/m/typo3/reference-coreapi/(main|11.5)/en-us/ApiOverview/Internationalization(.*) {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Localization$2;
}
location ~ ^/m/typo3/reference-coreapi/main/en-us/ApiOverview/JavaScript(.*) {
    return 303 /m/typo3/reference-coreapi/main/en-us/ApiOverview/Backend/JavaScript$1;
}
location ~ ^/m/typo3/reference-coreapi/(main|11.5)/en-us/ApiOverview/AccessControl(.*) {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Backend/AccessControl$2;
}
location ~ ^/m/typo3/reference-coreapi/(main|11.5)/en-us/ApiOverview/BroadcastChannels(.*) {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Backend/BroadcastChannels$2;
}
location ~ ^/m/typo3/reference-coreapi/(main|11.5)/en-us/ApiOverview/ExtensionScanner/Index.html {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ExtensionArchitecture/HowTo/UpdateExtensions/ExtensionScanner.html;
}
location ~ ^/m/typo3/reference-coreapi/(main|11.5)/en-us/ApiOverview/ExtensionScanner(.*) {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ExtensionArchitecture/HowTo/UpdateExtensions/ExtensionScanner$2;
}
location ~ ^/m/typo3/reference-coreapi/(main|11.5)/en-us/ApiOverview/UpdateWizards(.*) {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ExtensionArchitecture/HowTo/UpdateExtensions/UpdateWizards$2;
}

location ~ ^/m/typo3/reference-coreapi/(main|11.5|10.4)/en-us/TypoScriptSyntax(.*) {
    return 303 /m/typo3/reference-typoscript/$1/en-us/Syntax$2;
}
location ~ ^/m/typo3/reference-coreapi/(main|11.5|10.4)/en-us/ApiOverview/Hooks(.*) {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Events$2;
}
location ~ ^/m/typo3/reference-coreapi/(main|11.5|10.4)/en-us/Events(.*) {
    return 303 /m/typo3/reference-coreapi/$1/en-us/ApiOverview/Events$2;
}

# typo3/reference-coreapi
# redirect to use en-us
location ~ ^/typo3cms/CoreApiReference/6.2(.*)$ {
    return 303 /m/typo3/reference-coreapi/6.2/en-us$1;
}
location ~ ^/typo3cms/CoreApiReference/7.6(.*)$ {
    return 303 /m/typo3/reference-coreapi/7.6/en-us$1;
}
location ~ ^/typo3cms/CoreApiReference/8.7(.*)$ {
    return 303 /m/typo3/reference-coreapi/8.7/en-us$1;
}
location ~ ^/typo3cms/CoreApiReference/latest(.*)$ {
    return 303 /m/typo3/reference-coreapi/main/en-us$1;
}
location ~ ^/typo3cms/CoreApiReference/stable(.*)$ {
    return 303 /m/typo3/reference-coreapi/main/en-us$1;
}
location ~ ^/typo3cms/CoreApiReference(.*)$ {
    return 303 /m/typo3/reference-coreapi/main/en-us$1;
}

# Extension Development rewrite 2022 main

location ~ ^/m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/ExtensionKey/Index.html {
    return 303 /m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/BestPractises/ExtensionKey.html;
}
location ~ ^/m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/NamingConventions/Index.html {
    return 303 /m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/BestPractises/NamingConventions.html;
}
location ~ ^/m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/ConfigurationFiles/Index.html {
    return 303 /m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/BestPractises/ConfigurationFiles.html;
}
location ~ ^/m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/Resources/Index.html {
    return 303 /m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/Concepts/FurtherReading.html;
}
location ~ ^/m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/Introduction/Index.html {
    return 303 /m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/Concepts/Introduction.html;
}
location ~ ^/m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/SystemAndLocalExtensions/Index.html {
    return 303 /m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/Concepts/SystemAndLocalExtensions.html;
}
location ~ ^/m/typo3/reference-coreapi/main/en-us/ApiOverview/BackendModules/(.*) {
    return 303 /m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/HowTo/BackendModule/$1;
}
location ~ ^/m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/ExtendingTca/(.*) {
    return 303 /m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/HowTo/ExtendingTca/$1;
}
location ~ ^/m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/FrontendPlugin/(.*) {
    return 303 /m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/HowTo/FrontendPlugin/$1;
}
location ~ ^/m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/PublishExtension/ {
    return 303 /m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/HowTo/PublishExtension/;
}
location ~ ^/m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/CreateNewDistribution/Index.html {
    return 303 /m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/HowTo/CreateNewDistribution.html;
}
location ~ ^/m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/CreateNewExtension/Index.html {
    return 303 /m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/HowTo/CreateNewExtension.html;
}
location ~ ^/m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/CustomExtensionRepository/Index.html {
    return 303 /m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/HowTo/CustomExtensionRepository.html;
}
location ~ ^/m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/Documentation/Index.html {
    return 303 /m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/HowTo/Documentation.html;
}
location ~ ^/m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/ExtensionManagement/Index.html {
    return 303 /m/typo3/reference-coreapi/main/en-us/ExtensionArchitecture/HowTo/ExtensionManagement.html;
}

# Extension Development rewrite 2022 LTS 11.5

location ~ ^/m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/ExtensionKey/Index.html {
    return 303 /m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/BestPractises/ExtensionKey.html;
}
location ~ ^/m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/NamingConventions/Index.html {
    return 303 /m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/BestPractises/NamingConventions.html;
}
location ~ ^/m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/ConfigurationFiles/Index.html {
    return 303 /m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/BestPractises/ConfigurationFiles.html;
}
location ~ ^/m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/Resources/Index.html {
    return 303 /m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/Concepts/FurtherReading.html;
}
location ~ ^/m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/Introduction/Index.html {
    return 303 /m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/Concepts/Introduction.html;
}
location ~ ^/m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/SystemAndLocalExtensions/Index.html {
    return 303 /m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/Concepts/SystemAndLocalExtensions.html;
}
location ~ ^/m/typo3/reference-coreapi/11.5/en-us/ApiOverview/BackendModules/(.*) {
    return 303 /m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/HowTo/BackendModule/$1;
}
location ~ ^/m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/ExtendingTca/(.*) {
    return 303 /m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/HowTo/ExtendingTca/$1;
}
location ~ ^/m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/FrontendPlugin/(.*) {
    return 303 /m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/HowTo/FrontendPlugin/$1;
}
location ~ ^/m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/PublishExtension/ {
    return 303 /m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/HowTo/PublishExtension/;
}
location ~ ^/m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/CreateNewDistribution/Index.html {
    return 303 /m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/HowTo/CreateNewDistribution.html;
}
location ~ ^/m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/CreateNewExtension/Index.html {
    return 303 /m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/HowTo/CreateNewExtension.html;
}
location ~ ^/m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/CustomExtensionRepository/Index.html {
    return 303 /m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/HowTo/CustomExtensionRepository.html;
}
location ~ ^/m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/Documentation/Index.html {
    return 303 /m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/HowTo/Documentation.html;
}
location ~ ^/m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/ExtensionManagement/Index.html {
    return 303 /m/typo3/reference-coreapi/11.5/en-us/ExtensionArchitecture/HowTo/ExtensionManagement.html;
}

# typo3/guide-contributionworkflow
location ~ ^/typo3cms/ContributionWorkflowGuide/(latest|stable|main|master)(.*) {
    return 303 /m/typo3/guide-contributionworkflow/main/en-us$2;
}
location ~ ^/typo3cms/ContributionWorkflowGuide(.*) {
    return 303 /m/typo3/guide-contributionworkflow/main/en-us$1;
}

# typo3/guide-installation
location ~ ^/typo3cms/InstallationGuide/6.2(.*) {
    return 303 /m/typo3/guide-installation/6.2/en-us$1;
}
location ~ ^/typo3cms/InstallationGuide/7.6(.*) {
    return 303 /m/typo3/guide-installation/7.6/en-us$1;
}
location ~ ^/typo3cms/InstallationGuide/8.7(.*) {
    return 303 /m/typo3/guide-installation/8.7/en-us$1;
}
location ~ ^/typo3cms/InstallationGuide/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/guide-installation/main/en-us$2;
}
location ~ ^/typo3cms/InstallationGuide(.*) {
    return 303 /m/typo3/guide-installation/main/en-us$1;
}

# typo3/book-extbasefluid
location ~ ^/typo3cms/ExtbaseFluidBook/8.7(.*) {
    return 303 /m/typo3/book-extbasefluid/8.7/en-us$1;
}
location ~ ^/typo3cms/ExtbaseFluidBook/9.5(.*) {
    return 303 /m/typo3/book-extbasefluid/9.5/en-us$1;
}
location ~ ^/typo3cms/ExtbaseFluidBook/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/book-extbasefluid/main/en-us$2;
}
location ~ ^/typo3cms/ExtbaseFluidBook(.*) {
    return 303 /m/typo3/book-extbasefluid/main/en-us$1;
}

# typo3/reference-typoscript
location ~ ^/typo3cms/TyposcriptReference/6.2(.*) {
    return 303 /m/typo3/reference-typoscript/6.2/en-us$1;
}
location ~ ^/typo3cms/TyposcriptReference/7.6(.*) {
    return 303 /m/typo3/reference-typoscript/7.6/en-us$1;
}
location ~ ^/typo3cms/TyposcriptReference/8.7(.*) {
    return 303 /m/typo3/reference-typoscript/8.7/en-us$1;
}
location ~ ^/typo3cms/TyposcriptReference/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/reference-typoscript/main/en-us$2;
}
location ~ ^/typo3cms/TyposcriptReference(.*) {
    return 303 /m/typo3/reference-typoscript/main/en-us$1;
}

# typo3/reference-tsconfig
location ~ ^/typo3cms/TSconfigReference/6.2(.*) {
    return 303 /m/typo3/reference-tsconfig/6.2/en-us$1;
}
location ~ ^/typo3cms/TSconfigReference/7.6(.*) {
    return 303 /m/typo3/reference-tsconfig/7.6/en-us$1;
}
location ~ ^/typo3cms/TSconfigReference/8.7(.*) {
    return 303 /m/typo3/reference-tsconfig/8.7/en-us$1;
}
location ~ ^/typo3cms/TSconfigReference/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/reference-typoscript/main/en-us$2;
}
location ~ ^/typo3cms/TSconfigReference(.*) {
    return 303 /m/typo3/reference-typoscript/main/en-us$1;
}
location ~ ^/m/typo3/reference-tsconfig/(main|13.4|12.4)/en-us/UsingSetting(.*) {
    return 303 /m/typo3/reference-typoscript/$1/en-us/UsingSettingTSconfig$2;
}
location ~ ^/m/typo3/reference-tsconfig/(main|13.4|12.4)/en-us(.*) {
    return 303 /m/typo3/reference-typoscript/$1/en-us$2;
}

# typo3/docs-how-to-document
location ~ ^/typo3cms/HowToDocument/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/docs-how-to-document/main/en-us$2;
}
location ~ ^/typo3cms/HowToDocument(.*) {
    return 303 /m/typo3/docs-how-to-document/main/en-us$1;
}

# typo3/tutorial-getting-started
location ~ ^/typo3cms/GettingStartedTutorial/7.6(.*) {
    return 303 /m/typo3/tutorial-getting-started/7.6/en-us$1;
}
location ~ ^/typo3cms/GettingStartedTutorial/8.7(.*) {
    return 303 /m/typo3/tutorial-getting-started/8.7/en-us$1;
}
location ~ ^/typo3cms/GettingStartedTutorial/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/tutorial-getting-started/main/en-us$2;
}
location ~ ^/typo3cms/GettingStartedTutorial(.*) {
    return 303 /m/typo3/tutorial-getting-started/main/en-us$1;
}
location ~ ^/Home/GettingStarted.html {
    return 303 /m/typo3/tutorial-getting-started/main/en-us/;
}

# typo3/docs-guide-render-typo3-documentation
location ~ ^/typo3cms/RenderTYPO3DocumentationGuide/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/docs-guide-render-typo3-documentation/main/en-us$2;
}
location ~ ^/typo3cms/RenderTYPO3DocumentationGuide(.*) {
    return 303 /m/typo3/docs-guide-render-typo3-documentation/main/en-us$1;
}

# typo3/tutorial-editors
location ~ ^/typo3cms/EditorsTutorial/7.6(.*) {
    return 303 /m/typo3/tutorial-editors/7.6/en-us$1;
}
location ~ ^/typo3cms/EditorsTutorial/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/tutorial-editors/main/en-us$2;
}
location ~ ^/typo3cms/EditorsTutorial(.*) {
    return 303 /m/typo3/tutorial-editors/main/en-us$1;
}

# typo3/guide-frontendlocalization
location ~ ^/typo3cms/FrontendLocalizationGuide/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/guide-frontendlocalization/main/en-us$2;
}
location ~ ^/typo3cms/FrontendLocalizationGuide(.*) {
    return 303 /m/typo3/guide-frontendlocalization/main/en-us$1;
}

# typo3/docs-snippets
location ~ ^/typo3cms/Snippets/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/docs-snippets/main/en-us$2;
}
location ~ ^/typo3cms/Snippets(.*) {
    return 303 /m/typo3/docs-snippets/main/en-us$1;
}

# typo3/demo-t3SphinxThemeRtd
location ~ ^/typo3cms/drafts/github/TYPO3-Documentation/t3SphinxThemeRtdDemoDocs/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/demo-t3SphinxThemeRtd/main/en-us$2;
}
location ~ ^/typo3cms/drafts/github/TYPO3-Documentation/t3SphinxThemeRtdDemoDocs(.*) {
    return 303 /m/typo3/demo-t3SphinxThemeRtd/main/en-us$1;
}

# typo3/reference-tca
location ~ ^/typo3cms/TCAReference/6.2(.*) {
    return 303 /m/typo3/reference-tca/6.2/en-us$1;
}
location ~ ^/typo3cms/TCAReference/7.6(.*) {
    return 303 /m/typo3/reference-tca/7.6/en-us$1;
}
location ~ ^/typo3cms/TCAReference/8.7(.*) {
    return 303 /m/typo3/reference-tca/8.7/en-us$1;
}
location ~ ^/typo3cms/TCAReference/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/reference-tca/main/en-us$2;
}
location ~ ^/typo3cms/TCAReference(.*) {
    return 303 /m/typo3/reference-tca/main/en-us$1;
}

# typo3/tutorial-sitepackage
location ~ ^/typo3cms/SitePackageTutorial/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/tutorial-sitepackage/main/en-us$2;
}
location ~ ^/typo3cms/SitePackageTutorial(.*) {
    return 303 /m/typo3/tutorial-sitepackage/main/en-us$1;
}

# typo3/guide-tell-me-something-about
location ~ ^/typo3cms/TellMeSomethingAbout/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/guide-tell-me-something-about/main/en-us$2;
}
location ~ ^/typo3cms/TellMeSomethingAbout(.*) {
    return 303 /m/typo3/guide-tell-me-something-about/main/en-us$1;
}

# typo3/guide-extbasefluid
location ~ ^/typo3cms/ExtbaseGuide/6.2(.*) {
    return 303 /m/typo3/guide-extbasefluid/6.2/en-us$1;
}
location ~ ^/typo3cms/ExtbaseGuide/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/guide-extbasefluid/main/en-us$2;
}
location ~ ^/typo3cms/ExtbaseGuide(.*) {
    return 303 /m/typo3/guide-extbasefluid/main/en-us$1;
}

# typo3/guide-example-extension-manual
location ~ ^/typo3cms/ExtensionManualExample/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/guide-example-extension-manual/main/en-us$1;
}
location ~ ^/typo3cms/ExtensionManualExample(.*) {
    return 303 /m/typo3/guide-example-extension-manual/main/en-us$1;
}

# typo3/tutorial-typoscript-in-45-minutes
location ~ ^/typo3cms/TyposcriptIn45MinutesTutorial/6.2(.*) {
    return 303 /m/typo3/tutorial-typoscript-in-45-minutes/6.2/en-us$1;
}
location ~ ^/typo3cms/TyposcriptIn45MinutesTutorial/7.6(.*) {
    return 303 /m/typo3/tutorial-typoscript-in-45-minutes/7.6/en-us$1;
}
location ~ ^/typo3cms/TyposcriptIn45MinutesTutorial/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/reference-typoscript/main/en-us/Guide/$2;
}
location ~ ^/typo3cms/TyposcriptIn45MinutesTutorial(.*) {
    return 303 /m/typo3/reference-typoscript/main/en-us/Guide/$1;
}

# typo3/tutorial-templating-with-fluid
# typo3/tutorial-templating
location ~ ^/typo3cms/TemplatingTutorial/6.2(.*) {
    return 303 /m/typo3/tutorial-templating/6.2/en-us$1;
}
location ~ ^/typo3cms/TemplatingTutorial/7.6(.*) {
    return 303 /m/typo3/tutorial-templating/7.6/en-us$1;
}
location ~ ^/typo3cms/TemplatingTutorial/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/tutorial-templating/main/en-us$2;
}
location ~ ^/typo3cms/TemplatingTutorial(.*) {
    return 303 /m/typo3/tutorial-templating/main/en-us$1;
}
location ~ ^/m/typo3/tutorial-templating-with-fluid/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/tutorial-templating/main/en-us$2;
}


# typo3/teams-t3docteam
location ~ ^/typo3cms/Teams/T3DocTeam/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/team-t3docteam/main/en-us$2;
}
location ~ ^/typo3cms/Teams/T3DocTeam(.*) {
   return 303 /m/typo3/team-t3docteam/main/en-us$1;
}

# typo3/team-t3oteam
location ~ ^/typo3cms/Teams/T3oTeam/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/team-t3oteam/main/en-us$2;
}
location ~ ^/typo3cms/Teams/T3oTeam(.*) {
    return 303 /m/typo3/team-t3oteam/main/en-us$1;
}

# typo3/guide-security
location ~ ^/typo3cms/SecurityGuide/8.7(.*) {
    return 303 /m/typo3/guide-security/8.7/en-us$1;
}
location ~ ^/typo3cms/SecurityGuide/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/guide-security/main/en-us$2;
}
location ~ ^/typo3cms/SecurityGuide(.*) {
    return 303 /m/typo3/guide-security/main/en-us$1;
}

# typo3/reference-inside
location ~ ^/typo3cms/InsideTypo3Reference/7.6(.*) {
    return 303 /m/typo3/reference-inside/7.6/en-us$1;
}
location ~ ^/typo3cms/InsideTypo3Reference/8.7(.*) {
    return 303 /m/typo3/reference-inside/8.7/en-us$1;
}
location ~ ^/typo3cms/InsideTypo3Reference/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/reference-inside/main/en-us$2;
}
location ~ ^/typo3cms/InsideTypo3Reference(.*) {
    return 303 /m/typo3/reference-inside/main/en-us$1;
}

# typo3/reference-coding-guidelines
#   was merged into TYPO3 Explained and will be taken offline and archived
#   >> redirect all to new location in reference-coreapi (301)
location ~ ^/typo3cms/CodingGuidelinesReference/(6.2|7.6|8.7|9.5|master|main|stable|latest)/.* {
    return 301 /m/typo3/reference-coreapi/$1/en-us/CodingGuidelines/Index.html;
}
location ~ ^/m/typo3/reference-coding-guidelines/(6.2|7.6|8.7|9.5|master|main|stable|latest)/.* {
    return 301 /m/typo3/reference-coreapi/$1/en-us/CodingGuidelines/Index.html;
}

# typo3/reference-typoscript-syntax
#   was merged into TYPO3 Explained and will be taken offline and archived
#   >> redirect all to new location in reference-coreapi (301)
location ~ ^/typo3cms/TyposcriptSyntaxReference/(6.2|7.6|8.7|master|main|stable|latest)/.* {
    return 301 /m/typo3/reference-typoscript/($1)/en-us/Syntax/Index.html;
}
location ~ ^/m/typo3/reference-typoscript-syntax/(6.2|7.6|8.7|master|main|stable|latest)/.* {
    return 303 /m/typo3/reference-typoscript/$1/en-us/Syntax/Index.html;
}

# typo3/reference-services
location ~ ^/typo3cms/Typo3ServicesReference/7.6(.*) {
    return 303 /m/typo3/reference-services/7.6/en-us$1;
}
location ~ ^/typo3cms/Typo3ServicesReference/8.7(.*) {
    return 303 /m/typo3/reference-services/8.7/en-us$1;
}
location ~ ^/typo3cms/Typo3ServicesReference/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/reference-services/main/en-us$2;
}
location ~ ^/typo3cms/Typo3ServicesReference(.*) {
    return 303 /m/typo3/reference-services/main/en-us$1;
}

# typo3/reference-fal
location ~ ^/typo3cms/FileAbstractionLayerReference/6.2(.*) {
    return 303 /m/typo3/reference-fal/6.2/en-us$1;
}
location ~ ^/typo3cms/FileAbstractionLayerReference/8.7(.*) {
    return 303 /m/typo3/reference-fal/8.7/en-us$1;
}
location ~ ^/typo3cms/FileAbstractionLayerReference/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/reference-fal/main/en-us$2;
}
location ~ ^/typo3cms/FileAbstractionLayerReference(.*) {
    return 303 /m/typo3/reference-fal/main/en-us$1;
}

# typo3/reference-skinning
location ~ ^/typo3cms/SkinningReference/(master|main|stable|latest)(.*) {
    return 303 /m/typo3/reference-skinning/main/en-us$2;
}
location ~ ^/typo3cms/SkinningReference(.*) {
    return 303 /m/typo3/reference-skinning/main/en-us$1;
}


# Redirects for system extensions:
# * versions latest, 8.7 and 9.5 are redirected to new rendering locations
# * versions 7.6 and 6.2 are kept as "stalled" renderings at typo3cms/extensions/ext-key/version , those will never re-render
# * "no-version" are redirected to new rendering location master, but NOT for "stalled" versions
# -> access to interphinx linking 'typo3cms/extensions/felogn/objects.inv' still works AND is redirected to "new-location/main/objects.inv"
#
# !!! URLs with 2-part versions or 3-part ersions may exist for extensions


# typo3/cms-felogin
location ~ ^/typo3cms/extensions/felogin/8.7(.*) {
    return 303 /c/typo3/cms-felogin/8.7/en-us$1;
}
location ~ ^/typo3cms/extensions/felogin/9.5(.*) {
    return 303 /c/typo3/cms-felogin/9.5/en-us$1;
}
location ~ ^/typo3cms/extensions/felogin/(master|main|stable|latest)(.*) {
    return 303 /c/typo3/cms-felogin/main/en-us$2;
}
location ~ ^/typo3cms/extensions/felogin(/(?:(?!(7\.6|6\.2)).*))?$ {
    return 303 /c/typo3/cms-felogin/main/en-us/$1;
}

# typo3/cms-fluid-styled-content
location ~ ^/typo3cms/extensions/fluid_styled_content/8.7(.*) {
    return 303 /c/typo3/cms-fluid-styled-content/8.7/en-us$1;
}
location ~ ^/typo3cms/extensions/fluid_styled_content/9.5(.*) {
    return 303 /c/typo3/cms-fluid-styled-content/9.5/en-us$1;
}
location ~ ^/typo3cms/extensions/fluid_styled_content/(master|main|stable|latest)(.*) {
    return 303 /c/typo3/cms-fluid-styled-content/main/en-us$2;
}
location ~ ^/typo3cms/extensions/fluid_styled_content((?!(/7\.6)).*) {
    return 303 /c/typo3/cms-fluid-styled-content/main/en-us$1;
}

# typo/cms-form
location ~ ^/typo3cms/extensions/form/8.7(.*) {
    return 303 /c/typo3/cms-form/8.7/en-us$1;
}
location ~ ^/typo3cms/extensions/form/9.5(.*) {
    return 303 /c/typo3/cms-form/9.5/en-us$1;
}
location ~ ^/typo3cms/extensions/form/(master|main|stable|latest)(.*) {
    return 303 /c/typo3/cms-form/main/en-us$2;
}
location ~ ^/typo3cms/extensions/form(/(?:(?!(7\.6|6\.2)).*))?$ {
    return 303 /c/typo3/cms-form/main/en-us/$1;
}

# typo3/cms-indexed-search
location ~ ^/typo3cms/extensions/indexed_search/8.7(.*) {
    return 303 /c/typo3/cms-indexed-search/8.7/en-us$1;
}
location ~ ^/typo3cms/extensions/indexed_search/9.5(.*) {
    return 303 /c/typo3/cms-indexed-search/9.5/en-us$1;
}
location ~ ^/typo3cms/extensions/indexed_search/(master|main|stable|latest)(.*) {
    return 303 /c/typo3/cms-indexed-search/main/en-us$2;
}
location ~ ^/typo3cms/extensions/indexed_search(/(?:(?!(7\.6|6\.2)).*))?$ {
    return 303 /c/typo3/cms-indexed-search/main/en-us/$1;
}

# typo3/cms-linkvalidator
location ~ ^/typo3cms/extensions/linkvalidator/8.7(.*) {
    return 303 /c/typo3/cms-linkvalidator/8.7/en-us$1;
}
location ~ ^/typo3cms/extensions/linkvalidator/9.5(.*) {
    return 303 /c/typo3/cms-linkvalidator/9.5/en-us$1;
}
location ~ ^/typo3cms/extensions/linkvalidator/(master|main|stable|latest)(.*) {
    return 303 /c/typo3/cms-linkvalidator/main/en-us$2;
}
location ~ ^/typo3cms/extensions/linkvalidator(/(?:(?!(7\.6|6\.2)).*))?$ {
    return 303 /c/typo3/cms-linkvalidator/main/en-us/$1;
}

#typo3/cms-recycler
location ~ ^/typo3cms/extensions/recycler/8.7(.*) {
    return 303 /c/typo3/cms-recycler/8.7/en-us$1;
}
location ~ ^/typo3cms/extensions/recycler/9.5(.*) {
    return 303 /c/typo3/cms-recycler/9.5/en-us$1;
}
location ~ ^/typo3cms/extensions/recycler/(master|main|stable|latest)(.*) {
    return 303 /c/typo3/cms-recycler/main/en-us$2;
}
location ~ ^/typo3cms/extensions/recycler(/(?:(?!(7\.6|6\.2)).*))?$ {
    return 303 /c/typo3/cms-recycler/main/en-us/$1;
}

# typo3/cms-rte-ckeditor
location ~ ^/typo3cms/extensions/rte_ckeditor/8.7(.*) {
    return 303 /c/typo3/cms-rte-ckeditor/8.7/en-us$1;
}
location ~ ^/typo3cms/extensions/rte_ckeditor/9.5(.*) {
    return 303 /c/typo3/cms-rte-ckeditor/9.5/en-us$1;
}
location ~ ^/typo3cms/extensions/rte_ckeditor/(master|main|stable|latest)(.*) {
    return 303 /c/typo3/cms-rte-ckeditor/main/en-us$2;
}
location ~ ^/typo3cms/extensions/rte_ckeditor(.*) {
    return 303 /c/typo3/cms-rte-ckeditor/main/en-us$1;
}

# typo3/cms-scheduler
location ~ ^/typo3cms/extensions/scheduler/8.7(.*) {
    return 303 /c/typo3/cms-scheduler/8.7/en-us$1;
}
location ~ ^/typo3cms/extensions/scheduler/9.5(.*) {
    return 303 /c/typo3/cms-scheduler/9.5/en-us$1;
}
location ~ ^/typo3cms/extensions/scheduler/(master|main|stable|latest)(.*) {
    return 303 /c/typo3/cms-scheduler/main/en-us$2;
}
location ~ ^/typo3cms/extensions/scheduler(/(?:(?!(7\.6|6\.2)).*))?$ {
    return 303 /c/typo3/cms-scheduler/main/en-us/$1;
}

# typo3/cms-workspaces
location ~ ^/typo3cms/extensions/workspaces/8.7(.*) {
    return 303 /c/typo3/cms-workspaces/8.7/en-us$1;
}
location ~ ^/typo3cms/extensions/workspaces/9.5(.*) {
    return 303 /c/typo3/cms-workspaces/9.5/en-us$1;
}
location ~ ^/typo3cms/extensions/workspaces/(master|main|stable|latest)(.*) {
    return 303 /c/typo3/cms-workspaces/main/en-us$2;
}
location ~ ^/typo3cms/extensions/workspaces(/(?:(?!(7\.6|6\.2)).*))?$ {
    return 303 /c/typo3/cms-workspaces/main/en-us/$1;
}

# typo3/cms-core - had only lastest version online on old server
location ~ ^/typo3cms/extensions/core/(master|main|stable|latest)(.*) {
    return 303 /c/typo3/cms-core/main/en-us$2;
}
location ~ ^/typo3cms/extensions/core(.*) {
    return 303 /c/typo3/cms-core/main/en-us$1;
}

# Redirect for any version of the Changelog to main. We only support the main branch here
location ~ ^/c/typo3/cms-core/(?!main)([^/]+)/en-us(.*) {
    return 303 /c/typo3/cms-core/main/en-us$2;
}

# friendsoftypo3/adodb
location ~ ^typo3cms/extensions/adodb/8.4.0(.*) {
    return 303 /p/friendsoftypo3/adodb/8.4/en-us$1;
}
location ~ ^typo3cms/extensions/adodb/(master|main|stable|latest)(.*) {
    return 303 /p/friendsoftypo3/adodb/main/en-us$2;
}
location ~ ^typo3cms/extensions/adodb(.*) {
    return 303 /p/friendsoftypo3/adodb/main/en-us$1;
}

# typo3/cms-css-styled-content
location ~ ^/typo3cms/extensions/css_styled_content/8.7(.*) {
    return 303 /c/typo3/cms-css-styled-content/8.7/en-us$1;
}
location ~ ^/typo3cms/extensions/css_styled_content/(master|main|stable|latest)(.*) {
    return 303 /c/typo3/cms-css-styled-content/8.7/en-us$2;
}
location ~ ^/typo3cms/extensions/css_styled_content(/(?:(?!(7\.6|6\.2)).*))?$ {
    return 303 /c/typo3/cms-css-styled-content/8.7/en-us/$1;
}

# friendsoftypo3/dbal
location ~ ^/typo3cms/extensions/dbal/8.4.1(.*) {
    return 303 /p/friendsoftypo3/dbal/8.4/en-us$1;
}
location ~ ^/typo3cms/extensions/dbal/(master|main|stable|latest)(.*) {
    return 303 /p/friendsoftypo3/dbal/main/en-us$2;
}
location ~ ^/typo3cms/extensions/dbal(/(?:(?!(7\.6|6\.2)).*))?$ {
    return 303 /p/friendsoftypo3/dbal/main/en-us/$1;
}

# friendsoftypo3/openid
location ~ ^/typo3cms/extensions/openid/7.6.4(.*) {
    return 303 /p/friendsoftypo3/openid/7.6/en-us$1;
}
location ~ ^/typo3cms/extensions/openid/8.0.2(.*) {
    return 303 /p/friendsoftypo3/openid/8.0/en-us$1;
}
location ~ ^/typo3cms/extensions/openid/8.1.0(.*) {
    return 303 /p/friendsoftypo3/openid/8.1/en-us$1;
}
location ~ ^/typo3cms/extensions/openid/8.1.1(.*) {
    return 303 /p/friendsoftypo3/openid/8.1/en-us$1;
}
location ~ ^/typo3cms/extensions/openid/(master|main|stable|latest)(.*) {
    return 303 /p/friendsoftypo3/openid/main/en-us$2;
}
location ~ ^/typo3cms/extensions/openid((?!(/6\.2)).*) {
    return 303 /p/friendsoftypo3/openid/main/en-us$1;
}

# typo3/cms-rsaauth
location ~ ^/typo3cms/extensions/rsaauth/8.7(.*) {
    return 303 /c/typo3/cms-rsaauth/8.7/en-us$1;
}
location ~ ^/typo3cms/extensions/rsaauth/9.5(.*) {
    return 303 /c/typo3/cms-rsaauth/8.5/en-us$1;
}
location ~ ^/typo3cms/extensions/rsaauth/(master|main|stable|latest)(.*) {
    return 303 /c/typo3/cms-rsaauth/main/en-us$1;
}
location ~ ^/typo3cms/extensions/rsaauth(/(?:(?!(7\.6|6\.2)).*))?$ {
    return 303 /c/typo3/cms-rsaauth/main/en-us/$1;
}

# typo3/cms-rtehtmlarea
# Specific for "current" extension detail page in TER

location ~ ^/typo3cms/extensions/rtehtmlarea/8.7.2(.*) {
    return 303 /p/friendsoftypo3/rtehtmlarea/8.7/en-us$1;
}
location ~ ^/typo3cms/extensions/rtehtmlarea/8.7/(.*) {
    return 303 /p/friendsoftypo3/rtehtmlarea/8.7/en-us/$1;
}
location ~ ^/typo3cms/extensions/rtehtmlarea/(master|main|stable|latest)(.*) {
    return 303 /p/friendsoftypo3/rtehtmlarea/main/en-us$2;
}
location ~ ^/typo3cms/extensions/rtehtmlarea(/(?:(?!(7\.6|6\.2|8\.7)).*))?$ {
    return 303 /p/friendsoftypo3/rtehtmlarea/main/en-us/$1;
}

# typo3/cms-saltedpasswords
location ~ ^/typo3cms/extensions/saltedpasswords/8.7(.*) {
    return 303 /c/typo3/cms-saltedpasswords/main/en-us$1;
}
location ~ ^/typo3cms/extensions/saltedpasswords/(master|main|stable|latest)(.*) {
    return 303 /c/typo3/cms-saltedpasswords/main/en-us$2;
}
location ~ ^/typo3cms/extensions/saltedpasswords(/(?:(?!(7\.6|6\.2)).*))?$ {
    return 303 /c/typo3/cms-saltedpasswords/main/en-us/$1;
}

# typo3/cms-sys-action
location ~ ^/typo3cms/extensions/sys_action/8.7(.*) {
    return 303 /c/typo3/cms-sys-action/8.7/en-us$1;
}
location ~ ^/typo3cms/extensions/sys_action/9.5(.*) {
    return 303 /c/typo3/cms-sys-action/9.5/en-us$1;
}
location ~ ^/typo3cms/extensions/sys_action/(master|main|stable|latest)(.*) {
    return 303 /c/typo3/cms-sys-action/main/en-us$2;
}
location ~ ^/typo3cms/extensions/sys_action(/(?:(?!(7\.6|6\.2)).*))?$ {
    return 303 /c/typo3/cms-sys-action/main/en-us/$1;
}

# typo3/cms-taskcenter
location ~ ^/typo3cms/extensions/taskcenter/8.7(.*) {
    return 303 /c/typo3/cms-taskcenter/8.7/en-us$1;
}
location ~ ^/typo3cms/extensions/taskcenter/9.5(.*) {
    return 303 /c/typo3/cms-taskcenter/9.5/en-us$1;
}
location ~ ^/typo3cms/extensions/taskcenter/(master|latest|stable)(.*) {
    return 303 /c/typo3/cms-taskcenter/main/en-us$2;
}
location ~ ^/typo3cms/extensions/taskcenter(/(?:(?!(7\.6|6\.2)).*))?$ {
    return 303 /c/typo3/cms-taskcenter/main/en-us/$1;
}

location ~ ^/typo3cms/extensions/feusersmap/(master|latest|stable)/(.*) {
    return 303 /p/wsr/feusersmap/main/en-us/$2;
}

location ~ ^/typo3cms/extensions/externalimport_tut/(master|latest|stable)/(.*) {
    return 303 /p/cobweb/externalimport_tut/main/en-us/$2;
}

# getting started rewrite 2024
location ~ ^/m/typo3/tutorial-getting-started/(main|13.4|12.4)/en-us/Installation/TutorialDdev.html {
   return 303 https://docs.typo3.org/m/typo3/tutorial-getting-started/$1/en-us/Installation/Install.html;
}
location ~ ^/m/typo3/tutorial-getting-started/(main|13.4|12.4)/en-us/UserManagement/(.*) {
   return 303 https://docs.typo3.org/m/typo3/reference-coreapi/$1/en-us/Administration/UserManagement/$2;
}
location ~ ^/m/typo3/tutorial-getting-started/(main|13.4|12.4)/en-us/PermissionsManagement/(.*) {
   return 303 https://docs.typo3.org/m/typo3/reference-coreapi/$1/en-us/Administration/PermissionsManagement/$2;
}
location ~ ^/m/typo3/tutorial-getting-started/(main|13.4|12.4)/en-us/Installation/TuneTYPO3.html {
   return 301 https://docs.typo3.org//permalink/t3coreapi:opcache@$1;
}
location ~ ^/m/typo3/reference-coreapi/(main|13.4|12.4)/en-us/AAdministration/Installation/TuneTYPO3.html {
   return 301 https://docs.typo3.org//permalink/t3coreapi:opcache@$1;
}
location ~ ^/m/typo3/reference-coreapi/(main|13.4|12.4)/en-us/Administration/Installation/ProductionSettings.html {
   return 301 https://docs.typo3.org/permalink/t3coreapi:production-settings@$1;
}
location ~ ^/m/typo3/reference-coreapi/(main|13.4|12.4)/en-us/Administration/Installation/Install.html {
   return 301 https://docs.typo3.org/permalink/t3coreapi:installation-index@$1;
}
location ~ ^/m/typo3/reference-coreapi/(main|13.4|12.4)/en-us/Administration/Installation/LegacyInstallation.html {
   return 301 https://docs.typo3.org/permalink/t3coreapi:classic-installation$1;
}
location ~ ^/m/typo3/reference-coreapi/(main|13.4|12.4)/en-us/Administration/Installation/Deployment/Index.html {
   return 301 https://docs.typo3.org/permalink/t3coreapi:deployment@$1;
}
location ~ ^/m/typo3/reference-coreapi/(main|13.4|12.4)/en-us/Administration/Installation/EnvironmentConfiguration.html {
   return 301 https://docs.typo3.org/permalink/t3coreapi:environment-configuration@$1;
}
location ~ ^/m/typo3/reference-coreapi/(main|13.4|12.4)/en-us/Administration/Installation/ReleaseIntegrity.html {
   return 301 https://docs.typo3.org/permalink/t3coreapi:release-integrity@$1;
}
location ~ ^/m/typo3/tutorial-getting-started/(main|13.4|12.4)/en-us/Installation/ReleaseIntegrity.html {
   return 301 https://docs.typo3.org/permalink/t3coreapi:release-integrity@$1;
}
location ~ ^/m/typo3/tutorial-getting-started/(main|13.4|12.4)/en-us/Installation/(Deployer/Index|Surf/Index|Magallanes/Index).html {
   return 301 https://docs.typo3.org/permalink/t3coreapi:deployment-deployer$1;
}
location ~ ^/m/typo3/tutorial-getting-started/(main|13.4|12.4)/en-us/Installation/(Surf/Index|Magallanes/Index).html {
   return 301 https://docs.typo3.org/permalink/t3coreapi:deployment-tools@$1;
}
location ~ ^/m/typo3/tutorial-getting-started/(main|13.4|12.4)/en-us/en-us/Troubleshooting/(TYPO3|SystemModules|PHP|Database).html {
   return 303 https://docs.typo3.org/m/typo3/reference-coreapi/$1/en-us/Administration/Troubleshooting/$2.html;
}

# Rewrite moved pages from Fluid Standalone documentation overhaul (2025)
location ~ ^/other/typo3fluid/fluid/(main|4\.0)/en-us/Usage/Syntax\.html {
    return 303 /other/typo3fluid/fluid/$1/en-us/Syntax/Index.html;
}
location ~ ^/other/typo3fluid/fluid/(main|4\.0)/en-us/Development/(Index|Decisions)\.html {
    return 303 /other/typo3fluid/fluid/$1/en-us/Extending/Index.html;
}
location ~ ^/other/typo3fluid/fluid/(main|4\.0)/en-us/Development/CreatingViewHelpers\.html {
    return 303 /other/typo3fluid/fluid/$1/en-us/Extending/ViewHelpers.html;
}
location ~ ^/other/typo3fluid/fluid/(main|4\.0)/en-us/Development/Expressions\.html {
    return 303 /other/typo3fluid/fluid/$1/en-us/Extending/ExpressionNodes.html;
}
location ~ ^/other/typo3fluid/fluid/(main|4\.0)/en-us/Development/Implementation\.html {
    return 303 /other/typo3fluid/fluid/$1/en-us/Integrating/Index.html;
}
location ~ ^/other/typo3fluid/fluid/(main|4\.0)/en-us/Usage/RunningExamples\.html {
    return 303 /other/typo3fluid/fluid/$1/en-us/Internals/RunningExamples.html;
}

# TYPO3 release integrity guide as requestes by ohader
# https://github.com/TYPO3-Documentation/TYPO3CMS-Guide-Installation/pull/82
location ~ ^/typo3cms/drafts/github/TYPO3Incubator/InfrastructureGuide/Releases(?:$|/.*) {
    return 303 /m/typo3/guide-installation/main/en-us/ReleaseIntegrity/Index.html;
}

# Catch all redirect for legacy extensions, redirecting stuff like
# typo3cms/extensions/news/Index.html (no version given!) to typo3cms/extensions/news/stable/Index.html
# stable exists in all extensions and links to the latest version
# If there are existing versions in the path (1.2.3 or 1.2 or latest or stable or master), these are not redirected
location ~ ^/typo3cms/extensions/([^/]+)$ {
    return 303 /typo3cms/extensions/$1/stable/;
}
location ~ ^/typo3cms/extensions/([^/]+)/((?!([0-9]+\.[0-9]+|[0-9]+\.[0-9]+\.[0-9]+|latest|stable|master)).*) {
    return 303 /typo3cms/extensions/$1/stable/$2;
}
# Last redirect in chain - redirect all extension URLs that didn't match before to TER.
# This is a prefix-based redirect, this is executed after all regex-based redirects in dynamic_redirects.conf.
location /typo3cms/extensions/ {
    rewrite ^/typo3cms/extensions/([^/]+)(/stable/?)? https://extensions.typo3.org/extension/$1 redirect;
}

#################################
# Third-party extension redirects
#################################

# aoepeople/crawler to tomasnorre/crawler
location ~ ^/p/aoepeople/crawler/(.*) {
    return 303 /p/tomasnorre/crawler/$2;
}

# eventnews
location ~ ^/typo3cms/extensions/eventnews/(.*) {
    return 303 /p/georgringer/eventnews/main/en-us/$2;
}

# contentblocks/content-blocks to friendsoftypo3/content-blocks
location ~ ^/p/contentblocks/content-blocks/(.*) {
    return 303 /p/friendsoftypo3/content-blocks/main/en-us/$2;
}
